#!/bin/bash
# SPDX-License-Identifier: GPL-2.0-or-later
# Copyright (C) 2020-present Fewtarius

. /etc/profile
DIR=$(realpath $(dirname $0))

. ${DIR}/update-utils

### Main

NETWORKING=$(online_status)
if [ "${NETWORKING}" == true ]
then
  getlatest
  UFILE="${PREFIX}-${TAG}.tar"
else
  if [ -e "${USTAGE}/${UFILE}" ]
  then
    TAG=$(echo ${UFILE} | awk 'BEGIN {FS="-"}; {split($3, a, /.tar/); print a[1]}')
  fi
fi

UPDATE_AVAILABLE=$(update_available)
if [ -z "${TAG}" ]
then
  echo "no"
  exit 1
fi

if [ "${TAG}" -ge "${MYVERSION}" ]
then
  echo "${TAG} ${BAND^^}"
  exit 0
else
  echo "no"
  exit 1
fi
